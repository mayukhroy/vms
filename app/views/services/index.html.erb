<!-- Services -->
<span class="tag-title">Services <%= link_to image_tag("/assets/icons/add.png"), new_service_path, :data => { :colorbox => true, :colorbox_height =>'400px', :colorbox_width =>'400px'}, class: "link-btn" , :title=>"Add Service" %></span>
<% if @empty_service %>
	<br/><br/><br/>
	Data not available.
	<br/><br/>
<% else %>
<br/>
<input type='text' placeholder='search here . . .' id='search'> 
<br/>
<p id="notice"><%= notice %></p>
<table id='searchTable'>
  <tr>
    <th>Vendor</th>
    <th>Services</th>
    <th>Projects</th>
    <th>Action</th>
  </tr>
  
  <% @vendors.each do |vendor| %>
  <tr>
    <td><%= vendor.name %></td>
    <td>
	<% @services.where(:vendor_id => vendor.id).each do |service| %>
		<%= service.name %><br/>
	<% end %>
	</td>
	<td>
	<% @services.where(:vendor_id => vendor.id).each do |service| %>
		<% if Project.where(:vendor_id => vendor.id).present? %>
			<% Project.where(:vendor_id => vendor.id).each do |project| %>
				<% project.services_ids.each do |service_id| %>
					<% if service_id.to_i == service.id.to_i %>
						<%= link_to project.name, project, :data => { :colorbox => true, :colorbox_width => '300px' }, class: "link-btn" , :title => "View Project Details" %>
					<% else  %>
						Not assigned
					<% end  %>
					<br/>
				<% end %>
			<% end  %>
		<% else  %>
			Not assigned
		<% end  %>
	<% end  %>
	</td>
	<td>
	<% @services.where(:vendor_id => vendor.id).each do |service| %>		
		<% if current_user.id==Vendor.find(service.vendor_id).user_id %>	
			<br/>
			<% Project.where(:vendor_id => vendor.id).each do |project| %>
				<% project.services_ids.each do |service_id| %>
					<% if service_id.to_i != service.id.to_i %>
						<%= link_to image_tag("/assets/icons/edit.png"), edit_service_path(service), :data => { :colorbox => true }, class: "link-btn", :data => { :colorbox => true, :colorbox_height =>'400px', :colorbox_width =>'400px'} %>
						<%= link_to image_tag("/assets/icons/delete.png"), service, method: :delete, data: { confirm: 'Are you sure?' }, class: "link-btn" %>
					<% end %>
				<% end %>
			<% end  %>
			<% if !Project.where(:vendor_id => vendor.id).present? %>
				<%= link_to image_tag("/assets/icons/edit.png"), edit_service_path(service), :data => { :colorbox => true }, class: "link-btn", :data => { :colorbox => true, :colorbox_height =>'400px', :colorbox_width =>'400px'} %>
				<%= link_to image_tag("/assets/icons/delete.png"), service, method: :delete, data: { confirm: 'Are you sure?' }, class: "link-btn" %>
			<% end %>
		<% end %>	
	<% end  %>
    <% end  %>
</td>
</tr>
  </table>
<div align="right"><%= will_paginate @services %></div>

<% end  %>


